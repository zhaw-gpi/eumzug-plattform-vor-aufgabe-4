<!--
Formular zum UserTask "Abschlussbestätigung anzeigen"
-->
<div class="alert alert-success" style="text-align: center" ng-show="feesExist">
    Die Zahlung wurde erfolgreich durchgeführt.
</div>

<div class="alert alert-info" style="text-align: center">
    <p>Sobald Sie auf Complete drücken, werden wir Ihre Angaben an die zuständigen Einwohnergemeinde(n) weiterleiten und Ihnen zudem eine Bestätigung zukommen lassen.</p>
    <p>Je nach Antwortzeiten der Gemeinden werden Sie dann in den nächsten Stunden oder Tagen von uns über die Entscheidungen der Gemeinde(n) benachrichtigt.</p>
</div>

<script cam-script type="text/form-script">
    // Die AngularJS-Scope-Variable camForm.variableManager wird einer lokalen
    // Variable zugewiesen, damit diese mehrfach verwendet werden kann in den
    // folgenden Funktionen
    var variableManager = camForm.variableManager;

    // Lädt beim Ereignis, dass das Formular geladen aber noch nicht angezeigt ist,
    // die Prozessvariablen feeMap von der Process Engine (Server) 
    // in das variableManager-Objekt (Client)
    camForm.on('form-loaded', function() {
        variableManager.fetchVariable('feeMap');
    });

    // Sobald alle Variablen client-seitig zur Verfügung stehen, wird zum einen
    // die feeMap einer Variable im AngularJS-Scope-Objekt übergeben
    // Zudem wird das Total aller Gebühren berechnet
    camForm.on('variables-fetched', function() {
        $scope.feeMap = variableManager.variableValue('feeMap');

        $scope.feesExist = false;
        
        if($scope.feeMap !== null){
            $scope.feesExist = true;
        }
    });
</script>

<form>

</form>